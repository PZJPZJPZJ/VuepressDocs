import{u as j,e as te,f as le,g as V,h as se,P as ae,t as ie,i as ue,j as b,k as x,l as re,w as _,m as l,n as oe,R as U,p as ne,q as ce,v as de,C as he,x as ve,y as me,z as pe,A as ge,B as ye,D as fe,E as He,F as B,G as F,H as Re,I as C,J as ke}from"./app-C9wC44_Y.js";const Se=["/","/guide/Alist.html","/guide/Android%20Debug%20Bridge.html","/guide/Aria2.html","/guide/BeatSaber.html","/guide/Bootmgr.html","/guide/Chrome.html","/guide/Clash.html","/guide/ComfyUI.html","/guide/DmitriRender.html","/guide/Docker.html","/guide/Duplicati.html","/guide/ESXi.html","/guide/Everything.html","/guide/Git.html","/guide/HomeAssistant.html","/guide/Immich.html","/guide/JaNetfilter.html","/guide/John%20the%20Ripper.html","/guide/Linux.html","/guide/Lucky.html","/guide/Magisk.html","/guide/Microsoft%20Activation%20Scripts.html","/guide/Mihomo.html","/guide/Minecraft.html","/guide/MySQL.html","/guide/NatTypeTester.html","/guide/NextTrace.html","/guide/OpenCore.html","/guide/OpenEUICC.html","/guide/OpenMediaVault.html","/guide/OpenWrt.html","/guide/Parsec%20Virtual%20Display.html","/guide/PSP%20Infinity.html","/guide/qBittorrent.html","/guide/Redpill%20Recovery.html","/guide/Sunshine.html","/guide/TVBox.html","/guide/Unlock%20Music.html","/guide/VuePress.html","/guide/Windows.html","/guide/WordPress.html","/guide/XMind.html","/guide/Xray%20UI.html","/guide/Yuzu.html","/404.html"],we="SEARCH_PRO_QUERY_HISTORY",y=j(we,[]),xe=()=>{const{queryHistoryCount:s}=C,a=s>0;return{enabled:a,queryHistory:y,addQueryHistory:i=>{a&&(y.value=Array.from(new Set([i,...y.value.slice(0,s-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},I=s=>Se[s.id]+("anchor"in s?`#${s.anchor}`:""),Ce="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=C,f=j(Ce,[]),Qe=()=>{const s=$>0;return{enabled:s,resultHistory:f,addResultHistory:a=>{if(s){const i={link:I(a),display:a.display};"header"in a&&(i.header=a.header),f.value=[i,...f.value.slice(0,$-1)]}},removeResultHistory:a=>{f.value=[...f.value.slice(0,a),...f.value.slice(a+1)]}}},qe=s=>{const a=he(),i=V(),Q=ve(),r=b(0),k=x(()=>r.value>0),m=me([]);return pe(()=>{const{search:p,terminate:q}=ge(),H=Re(c=>{const R=c.join(" "),{searchFilter:D=v=>v,splitWord:A,suggestionsFilter:M,...g}=a.value;R?(r.value+=1,p(c.join(" "),i.value,g).then(v=>D(v,R,i.value,Q.value)).then(v=>{r.value-=1,m.value=v}).catch(v=>{console.warn(v),r.value-=1,r.value||(m.value=[])})):m.value=[]},C.searchDelay-C.suggestDelay);_([s,i],([c])=>H(c),{immediate:!0}),ye(()=>{q()})}),{isSearching:k,results:m}};var Ae=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:a}){const i=le(),Q=V(),r=se(ae),{enabled:k,addQueryHistory:m,queryHistory:p,removeQueryHistory:q}=xe(),{enabled:H,resultHistory:c,addResultHistory:R,removeResultHistory:D}=Qe(),A=k||H,M=ie(s,"queries"),{results:g,isSearching:v}=qe(M),u=ue({isQuery:!0,index:0}),d=b(0),h=b(0),O=x(()=>A&&(p.value.length>0||c.value.length>0)),L=x(()=>g.value.length>0),P=x(()=>g.value[d.value]||null),Y=()=>{const{isQuery:e,index:t}=u;t===0?(u.isQuery=!e,u.index=e?c.value.length-1:p.value.length-1):u.index=t-1},J=()=>{const{isQuery:e,index:t}=u;t===(e?p.value.length-1:c.value.length-1)?(u.isQuery=!e,u.index=0):u.index=t+1},N=()=>{d.value=d.value>0?d.value-1:g.value.length-1,h.value=P.value.contents.length-1},W=()=>{d.value=d.value<g.value.length-1?d.value+1:0,h.value=0},X=()=>{h.value<P.value.contents.length-1?h.value+=1:W()},z=()=>{h.value>0?h.value-=1:N()},E=e=>e.map(t=>ke(t)?t:l(t[0],t[1])),G=e=>{if(e.type==="customField"){const t=fe[e.index]||"$content",[o,w=""]=He(t)?t[Q.value].split("$content"):t.split("$content");return e.display.map(n=>l("div",E([o,...n,w])))}return e.display.map(t=>l("div",E(t)))},S=()=>{d.value=0,h.value=0,a("updateQuery",""),a("close")},K=()=>k?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},r.value.queryHistory),p.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===t}],onClick:()=>{a("updateQuery",e)}},[l(B,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),q(t)}})]))])):null,Z=()=>H?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},r.value.resultHistory),c.value.map((e,t)=>l(U,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===t}],onClick:()=>{S()}},()=>[l(B,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(o=>E(o)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:F,onClick:o=>{o.preventDefault(),o.stopPropagation(),D(t)}})]))])):null;return re("keydown",e=>{if(s.isFocusing){if(L.value){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")X();else if(e.key==="Enter"){const t=P.value.contents[h.value];m(s.queries.join(" ")),R(t),i.push(I(t)),S()}}else if(H){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:t}=u;u.isQuery?(a("updateQuery",p.value[t]),e.preventDefault()):(i.push(c.value[t].link),S())}}}}),_([d,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!L.value:!O.value}],id:"search-pro-results"},s.queries.length?v.value?l(oe,{hint:r.value.searching}):L.value?l("ul",{class:"search-pro-result-list"},g.value.map(({title:e,contents:t},o)=>{const w=d.value===o;return l("li",{class:["search-pro-result-list-item",{active:w}]},[l("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((n,ee)=>{const T=w&&h.value===ee;return l(U,{to:I(n),class:["search-pro-result-item",{active:T,"aria-selected":T}],onClick:()=>{m(s.queries.join(" ")),R(n),S()}},()=>[n.type==="text"?null:l(n.type==="title"?ne:n.type==="heading"?ce:de,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?l("div",{class:"content-header"},n.header):null,l("div",G(n))])])})])})):r.value.emptyResult:A?O.value?[K(),Z()]:r.value.emptyHistory:r.value.emptyResult)}});export{Ae as default};
