import{u as j,e as te,f as le,g as _,h as se,P as ae,t as ue,i as ie,j as I,k as x,l as re,w as V,m as l,n as oe,R as U,p as ne,q as ce,v as de,C as he,x as ve,y as me,z as pe,A as ye,B as ge,D as fe,E as He,F as B,G as O,H as Re,I as C,J as ke}from"./app-C_0GBaQQ.js";const we=["/","/guide/Alist.html","/guide/Android%20Debug%20Bridge.html","/guide/Aria2.html","/guide/BMBF.html","/guide/Bootmgr.html","/guide/Chrome.html","/guide/Clash.html","/guide/ComfyUI.html","/guide/DmitriRender.html","/guide/Docker.html","/guide/Duplicati.html","/guide/ESXi.html","/guide/Everything.html","/guide/Git.html","/guide/HomeAssistant.html","/guide/Immich.html","/guide/JaNetfilter.html","/guide/John%20the%20Ripper.html","/guide/Lucky.html","/guide/Microsoft%20Activation%20Scripts.html","/guide/Mihomo.html","/guide/MySQL.html","/guide/NatTypeTester.html","/guide/NextTrace.html","/guide/OpenEUICC.html","/guide/Parsec%20Virtual%20Display.html","/guide/PSP%20Infinity.html","/guide/Redpill%20Recovery.html","/guide/TVBox.html","/guide/Unlock%20Music.html","/guide/VuePress.html","/guide/Windows.html","/guide/WordPress.html","/guide/XMind.html","/guide/Xray%20UI.html","/guide/Yuzu.html","/404.html"],Qe="SEARCH_PRO_QUERY_HISTORY",g=j(Qe,[]),xe=()=>{const{queryHistoryCount:s}=C,a=s>0;return{enabled:a,queryHistory:g,addQueryHistory:u=>{a&&(g.value=Array.from(new Set([u,...g.value.slice(0,s-1)])))},removeQueryHistory:u=>{g.value=[...g.value.slice(0,u),...g.value.slice(u+1)]}}},T=s=>we[s.id]+("anchor"in s?`#${s.anchor}`:""),Ce="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:$}=C,f=j(Ce,[]),Se=()=>{const s=$>0;return{enabled:s,resultHistory:f,addResultHistory:a=>{if(s){const u={link:T(a),display:a.display};"header"in a&&(u.header=a.header),f.value=[u,...f.value.slice(0,$-1)]}},removeResultHistory:a=>{f.value=[...f.value.slice(0,a),...f.value.slice(a+1)]}}},qe=s=>{const a=he(),u=_(),S=ve(),r=I(0),k=x(()=>r.value>0),m=me([]);return pe(()=>{const{search:p,terminate:q}=ye(),H=Re(c=>{const R=c.join(" "),{searchFilter:D=v=>v,splitWord:A,suggestionsFilter:b,...y}=a.value;R?(r.value+=1,p(c.join(" "),u.value,y).then(v=>D(v,R,u.value,S.value)).then(v=>{r.value-=1,m.value=v}).catch(v=>{console.warn(v),r.value-=1,r.value||(m.value=[])})):m.value=[]},C.searchDelay-C.suggestDelay);V([s,u],([c])=>H(c),{immediate:!0}),ge(()=>{q()})}),{isSearching:k,results:m}};var Ae=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:a}){const u=le(),S=_(),r=se(ae),{enabled:k,addQueryHistory:m,queryHistory:p,removeQueryHistory:q}=xe(),{enabled:H,resultHistory:c,addResultHistory:R,removeResultHistory:D}=Se(),A=k||H,b=ue(s,"queries"),{results:y,isSearching:v}=qe(b),i=ie({isQuery:!0,index:0}),d=I(0),h=I(0),F=x(()=>A&&(p.value.length>0||c.value.length>0)),L=x(()=>y.value.length>0),P=x(()=>y.value[d.value]||null),Y=()=>{const{isQuery:e,index:t}=i;t===0?(i.isQuery=!e,i.index=e?c.value.length-1:p.value.length-1):i.index=t-1},J=()=>{const{isQuery:e,index:t}=i;t===(e?p.value.length-1:c.value.length-1)?(i.isQuery=!e,i.index=0):i.index=t+1},N=()=>{d.value=d.value>0?d.value-1:y.value.length-1,h.value=P.value.contents.length-1},X=()=>{d.value=d.value<y.value.length-1?d.value+1:0,h.value=0},z=()=>{h.value<P.value.contents.length-1?h.value+=1:X()},G=()=>{h.value>0?h.value-=1:N()},E=e=>e.map(t=>ke(t)?t:l(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=fe[e.index]||"$content",[o,Q=""]=He(t)?t[S.value].split("$content"):t.split("$content");return e.display.map(n=>l("div",E([o,...n,Q])))}return e.display.map(t=>l("div",E(t)))},w=()=>{d.value=0,h.value=0,a("updateQuery",""),a("close")},K=()=>k?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},r.value.queryHistory),p.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===t}],onClick:()=>{a("updateQuery",e)}},[l(B,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:o=>{o.preventDefault(),o.stopPropagation(),q(t)}})]))])):null,Z=()=>H?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},r.value.resultHistory),c.value.map((e,t)=>l(U,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===t}],onClick:()=>{w()}},()=>[l(B,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(o=>E(o)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:o=>{o.preventDefault(),o.stopPropagation(),D(t)}})]))])):null;return re("keydown",e=>{if(s.isFocusing){if(L.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")z();else if(e.key==="Enter"){const t=P.value.contents[h.value];m(s.queries.join(" ")),R(t),u.push(T(t)),w()}}else if(H){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:t}=i;i.isQuery?(a("updateQuery",p.value[t]),e.preventDefault()):(u.push(c.value[t].link),w())}}}}),V([d,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!L.value:!F.value}],id:"search-pro-results"},s.queries.length?v.value?l(oe,{hint:r.value.searching}):L.value?l("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:t},o)=>{const Q=d.value===o;return l("li",{class:["search-pro-result-list-item",{active:Q}]},[l("div",{class:"search-pro-result-title"},e||r.value.defaultTitle),t.map((n,ee)=>{const M=Q&&h.value===ee;return l(U,{to:T(n),class:["search-pro-result-item",{active:M,"aria-selected":M}],onClick:()=>{m(s.queries.join(" ")),R(n),w()}},()=>[n.type==="text"?null:l(n.type==="title"?ne:n.type==="heading"?ce:de,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?l("div",{class:"content-header"},n.header):null,l("div",W(n))])])})])})):r.value.emptyResult:A?F.value?[K(),Z()]:r.value.emptyHistory:r.value.emptyResult)}});export{Ae as default};
